_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[51],{"5D78":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("wvHr");function a(t){return t.success?Object(r.b)({title:t.title,content:t.content,alertType:"success"}):Object(r.b)({title:t.title,content:t.content,alertType:"error"}),t.success}},"EE/t":function(t,e,n){"use strict";n.r(e);var r=n("o0o1"),a=n.n(r),s=n("HaE+"),u=n("1OyB"),c=n("vuIU"),i=n("JX7q"),o=n("Ji7U"),l=n("md7G"),f=n("foSv"),p=n("rePB"),h=n("q1tI"),d=n.n(h),b=n("8Kt/"),m=n.n(b),v=n("nOHt"),y=n("pJr+"),j=n("Au3V"),O=n("bTPZ"),_=n("tJ/W"),g=n("HXPj"),w=n("IgCw"),k=n("dSKx"),x=n("AoAR"),q=n("5D78"),S=d.a.createElement;function P(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(f.a)(t);if(e){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var E=function(t){Object(o.a)(n,t);var e=P(n);function n(t){var r;return Object(u.a)(this,n),r=e.call(this,t),Object(p.a)(Object(i.a)(r),"context",void 0),Object(p.a)(Object(i.a)(r),"getData",Object(s.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(x.p)(r.props.router.query.username);case 2:e=t.sent,r.setState({user:e});case 4:case"end":return t.stop()}}),t)})))),Object(p.a)(Object(i.a)(r),"update",Object(s.a)(a.a.mark((function t(){var e,n,s,u,c,i,o,l,f,p;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.setState({loading:!0}),e=r.state.user,n=e.username,s=e.email,u=e.ns_id,c=e.ns_name,i=e.ac_name,o=e.ac_island,l=e.qq,f=e.avatar,t.next=4,Object(x.P)(n,s,f,u,c,i,o,l,r.state.password);case 4:p=t.sent,Object(q.a)(p)&&(r.props.router.push("/user/[username]","/user/".concat(n)),r.context.callback({user:r.state.user})),r.setState({loading:!1});case 7:case"end":return t.stop()}}),t)})))),r.state={user:r.props.user,loading:!1,loadingAvatar:!1,password:""},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var t=this,e=[{key:"avatar",name:"\u5934\u50cf",self:!0,rewrite:function(t){return t.replace("http://","https://")}},{key:"username",name:"\u7528\u6237\u540d",self:!1},{key:"email",name:"\u90ae\u7bb1",self:!1},{key:"qq",name:"QQ \u53f7",self:!0},{key:"ns_id",name:"NS ID",self:!1,prefix:"SW",rewrite:function(t){return t.replace(/[^0-9\-]/g,"")}},{key:"ns_name",name:"NS \u540d\u79f0",self:!1},{key:"ac_name",name:"\u52a8\u68ee\u540d\u79f0",self:!1},{key:"ac_island",name:"\u52a8\u68ee\u5c9b\u540d",self:!1,suffix:"\u5c9b",rewrite:function(t){return t.length>0&&"\u5c9b"==t[t.length-1]&&(t=t.slice(0,t.length-1)),t}}],n=this.state.user.self?e:e.filter((function(t){return!t.self}));return S(O.a,{neumorphism:!0},S(k.a.Consumer,null,(function(e){return S(m.a,null,S("title",null,"".concat(t.props.router.query.username,"|\u7528\u6237\u9875|").concat(e.blog_name)))})),S(y.a,{direction:"TB",fullWidth:!0},S(g.a,{style:{fontSize:128,margin:"auto"},src:this.state.user.avatar}),S(w.a,{condition:this.state.user.self},S(y.a,null,S(j.b,{neumorphism:!0,loading:this.state.loadingAvatar,onClick:Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({loadingAvatar:!0}),e.next=3,Object(x.g)(t.state.user.email);case 3:n=e.sent,t.setState((function(t){var e=t.user;return e.avatar=n.avatar,{user:e,loadingAvatar:!1}}));case 5:case"end":return e.stop()}}),e)})))},"\u6839\u636e\u90ae\u7bb1\u66f4\u65b0 Github\u3001Gavatar \u5934\u50cf"),S("a",{href:"/api/user/qq_avatar",target:"_blank"},S(j.b,{neumorphism:!0,disabled:!this.state.user.qq_connected},"\u66f4\u65b0 QQ \u5934\u50cf")),S(j.b,{neumorphism:!0,onClick:function(){return t.getData()}},"\u5237\u65b0\u6570\u636e"))),S(y.a,{direction:"TB",fullWidth:!0},n.map((function(e){return t.state.user.self?S(_.j,{key:e.key,label:e.name,prefix:e.prefix,suffix:e.suffix,value:t.state.user[e.key],onChange:function(n){e.rewrite&&(n=e.rewrite(n)),t.setState((function(t){var r=t.user;return r[e.key]=n,{user:r}}))}}):S("p",null,e.prefix," ",t.state.user[e.key]," ",e.suffix)}))),S(w.a,{condition:this.state.user.self},S(y.a,null,S(_.j,{type:"password",placeholder:"\u5982\u679c\u4e0d\u9700\u8981\u4fee\u6539\u5bc6\u7801\u8bf7\u7559\u7a7a",value:this.state.password,onChange:function(e){return t.setState({password:e})}}),this.state.user.qq_connected?S(j.b,{neumorphism:!0,disabled:!0},"\u5df2\u7ed1\u5b9a QQ \u767b\u5f55"):S("a",{href:"/api/user/jump_to_qq?state=connect",target:"_blank"},S(j.b,{neumorphism:!0},"\u7ed1\u5b9a QQ \u767b\u5f55")),this.state.user.github_connected?S(j.b,{neumorphism:!0,disabled:!0},"\u5df2\u7ed1\u5b9a Github \u767b\u5f55"):S("a",{href:"/api/user/jump_to_github?state=connect",target:"_blank"},S(j.b,{neumorphism:!0},"\u7ed1\u5b9a Github \u767b\u5f55")),S(j.b,{neumorphism:!0,loading:this.state.loading,primary:!0,onClick:this.update},"\u66f4\u65b0\u4fe1\u606f")))))}}],[{key:"getInitialProps",value:function(){var t=Object(s.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(x.p)(e.query.username);case 2:return n=t.sent,t.abrupt("return",{user:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),n}(d.a.Component);Object(p.a)(E,"defaultProps",{}),Object(p.a)(E,"contextType",k.a),e.default=Object(v.withRouter)(E)},HXPj:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("q1tI"),a=n.n(r),s=n("bLBL"),u=n.n(s),c=a.a.createElement;function i(t){var e=t.src,n=t.className,r=t.style,a=t.children;return c("div",{className:[n,u.a.avatar].join(" "),style:r},!a&&e?c("img",{src:e}):a)}},IgCw:function(t,e,n){"use strict";var r=n("1OyB"),a=n("vuIU"),s=n("Ji7U"),u=n("md7G"),c=n("foSv"),i=n("rePB"),o=n("q1tI");function l(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(c.a)(t);if(e){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var f=function(t){Object(s.a)(n,t);var e=l(n);function n(t){return Object(r.a)(this,n),e.call(this,t)}return Object(a.a)(n,[{key:"render",value:function(){return this.props.condition?this.props.children:null}}]),n}(n.n(o).a.Component);Object(i.a)(f,"defaultProps",{condition:!0}),e.a=f},bLBL:function(t,e,n){t.exports={avatar:"avatar_avatar__1jw4O"}},rc3b:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/[username]",function(){return n("EE/t")}])}},[["rc3b",0,1,2,3,4,5,6,7,8,9]]]);