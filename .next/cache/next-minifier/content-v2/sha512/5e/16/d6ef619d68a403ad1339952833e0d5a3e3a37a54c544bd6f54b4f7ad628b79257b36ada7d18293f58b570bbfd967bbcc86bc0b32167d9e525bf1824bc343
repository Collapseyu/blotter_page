{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{\"EE/t\":function(t,e,n){\"use strict\";n.r(e);n(\"RV09\");var a=n(\"N9UN\"),r=n.n(a),s=(n(\"X1UN\"),n(\"hqwM\")),u=n.n(s),c=(n(\"SoD3\"),n(\"9xET\")),i=n.n(c),o=(n(\"1mXb\"),n(\"iJl9\")),l=n.n(o),f=(n(\"YKpo\"),n(\"ZPTe\")),p=n.n(f),d=(n(\"89vs\"),n(\"lbd2\")),h=n.n(d),b=(n(\"bAY4\"),n(\"4IMT\")),v=n.n(b),y=(n(\"SJAb\"),n(\"pWf2\")),m=n.n(y),w=n(\"o0o1\"),g=n.n(w),j=n(\"HaE+\"),O=n(\"1OyB\"),k=n(\"vuIU\"),x=n(\"JX7q\"),_=n(\"Ji7U\"),q=n(\"md7G\"),S=n(\"foSv\"),R=n(\"rePB\"),A=n(\"q1tI\"),C=n.n(A),D=n(\"8Kt/\"),I=n.n(D),P=n(\"nOHt\"),E=n(\"pJr+\"),J=n(\"dSKx\"),Q=n(\"AoAR\"),N=n(\"5D78\"),T=n(\"IgCw\"),G=C.a.createElement;function U(t){var e=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=Object(S.a)(t);if(e){var r=Object(S.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(q.a)(this,n)}}var B=function(t){Object(_.a)(n,t);var e=U(n);function n(t){var a;return Object(O.a)(this,n),a=e.call(this,t),Object(R.a)(Object(x.a)(a),\"context\",void 0),Object(R.a)(Object(x.a)(a),\"getData\",Object(j.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Q.p)(a.props.router.query.username);case 2:e=t.sent,a.setState({user:e});case 4:case\"end\":return t.stop()}}),t)})))),Object(R.a)(Object(x.a)(a),\"update\",Object(j.a)(g.a.mark((function t(){var e,n,r,s,u,c,i,o,l,f;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.setState({loading:!0}),e=a.state.user,n=e.username,r=e.email,s=e.ns_id,u=e.ns_name,c=e.ac_name,i=e.ac_island,o=e.qq,l=e.avatar,t.next=4,Object(Q.P)(n,r,l,s,u,c,i,o,a.state.password);case 4:f=t.sent,Object(N.b)(f)&&(a.props.router.push(\"/user/[username]\",\"/user/\".concat(n)),a.context.callback({user:a.state.user})),a.setState({loading:!1});case 7:case\"end\":return t.stop()}}),t)})))),a.state={user:a.props.user,loading:!1,loadingAvatar:!1,password:\"\"},a}return Object(k.a)(n,[{key:\"componentDidMount\",value:function(){this.getData()}},{key:\"render\",value:function(){var t=this,e=[{key:\"avatar\",name:\"\\u5934\\u50cf\",self:!0,rewrite:function(t){return t.replace(\"http://\",\"https://\")}},{key:\"username\",name:\"\\u7528\\u6237\\u540d\",self:!1},{key:\"email\",name:\"\\u90ae\\u7bb1\",self:!1},{key:\"qq\",name:\"QQ \\u53f7\",self:!0},{key:\"ns_id\",name:\"NS ID\",self:!1,prefix:\"SW\",rewrite:function(t){return t.replace(/[^0-9\\-]/g,\"\")}},{key:\"ns_name\",name:\"NS \\u540d\\u79f0\",self:!1},{key:\"ac_name\",name:\"\\u52a8\\u68ee\\u540d\\u79f0\",self:!1},{key:\"ac_island\",name:\"\\u52a8\\u68ee\\u5c9b\\u540d\",self:!1,suffix:\"\\u5c9b\",rewrite:function(t){return t.length>0&&\"\\u5c9b\"==t[t.length-1]&&(t=t.slice(0,t.length-1)),t}}],n=this.state.user.self?e:e.filter((function(t){return!t.self}));return G(r.a,null,G(J.a.Consumer,null,(function(e){return G(I.a,null,G(\"title\",null,\"\".concat(t.props.router.query.username,\"|\\u7528\\u6237\\u9875|\").concat(e.blog_name)))})),G(\"p\",{style:{textAlign:\"center\"}},G(m.a,{size:128,src:this.state.user.avatar})),G(T.a,{condition:this.state.user.self},G(E.b,{direction:\"horizontal\",flexCenter:!0},G(v.a,{loading:this.state.loadingAvatar,onClick:Object(j.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({loadingAvatar:!0}),e.next=3,Object(Q.g)(t.state.user.email);case 3:n=e.sent,t.setState((function(t){var e=t.user;return e.avatar=n.avatar,{user:e,loadingAvatar:!1}}));case 5:case\"end\":return e.stop()}}),e)})))},\"\\u6839\\u636e\\u90ae\\u7bb1\\u66f4\\u65b0 Github\\u3001Gavatar \\u5934\\u50cf\"),G(\"a\",{href:\"/api/user/qq_avatar\",target:\"_blank\"},G(v.a,{disabled:!this.state.user.qq_connected},\"\\u66f4\\u65b0 QQ \\u5934\\u50cf\")),G(v.a,{onClick:function(){return t.getData()}},\"\\u5237\\u65b0\\u6570\\u636e\"))),G(u.a,{dataSource:n,renderItem:function(e){return G(u.a.Item,{key:e.key},G(i.a,{style:{width:\"100%\"}},G(p.a,{span:4},G(h.a.Text,{strong:!0},e.name)),G(p.a,{span:20},t.state.user.self?G(l.a,{addonBefore:e.prefix,addonAfter:e.suffix,value:t.state.user[e.key],onChange:function(n){var a=n.target.value;e.rewrite&&(a=e.rewrite(a)),t.setState((function(t){var n=t.user;return n[e.key]=a,{user:n}}))}}):G(\"p\",null,e.prefix,\" \",t.state.user[e.key],\" \",e.suffix))))}}),G(T.a,{condition:this.state.user.self},G(E.b,null,G(l.a,{type:\"password\",placeholder:\"\\u5982\\u679c\\u4e0d\\u9700\\u8981\\u4fee\\u6539\\u5bc6\\u7801\\u8bf7\\u7559\\u7a7a\",value:this.state.password,onChange:function(e){return t.setState({password:e.target.value})}}),G(i.a,{justify:\"space-between\"},G(p.a,null,this.state.user.qq_connected?G(v.a,{disabled:!0},\"\\u5df2\\u7ed1\\u5b9a QQ \\u767b\\u5f55\"):G(\"a\",{href:\"/api/user/jump_to_qq?state=connect\",target:\"_blank\"},G(v.a,null,\"\\u7ed1\\u5b9a QQ \\u767b\\u5f55\"))),G(p.a,null,this.state.user.github_connected?G(v.a,{disabled:!0},\"\\u5df2\\u7ed1\\u5b9a Github \\u767b\\u5f55\"):G(\"a\",{href:\"/api/user/jump_to_github?state=connect\",target:\"_blank\"},G(v.a,null,\"\\u7ed1\\u5b9a Github \\u767b\\u5f55\"))),G(p.a,{style:{textAlign:\"right\"}},G(v.a,{loading:this.state.loading,type:\"primary\",onClick:this.update},\"\\u66f4\\u65b0\\u4fe1\\u606f\"))))))}}],[{key:\"getInitialProps\",value:function(){var t=Object(j.a)(g.a.mark((function t(e){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Q.p)(e.query.username);case 2:return n=t.sent,t.abrupt(\"return\",{user:n});case 4:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),n}(C.a.Component);Object(R.a)(B,\"defaultProps\",{}),Object(R.a)(B,\"contextType\",J.a),e.default=Object(P.withRouter)(B)},IgCw:function(t,e,n){\"use strict\";var a=n(\"1OyB\"),r=n(\"vuIU\"),s=n(\"Ji7U\"),u=n(\"md7G\"),c=n(\"foSv\"),i=n(\"rePB\"),o=n(\"q1tI\");function l(t){var e=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=Object(c.a)(t);if(e){var r=Object(c.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(u.a)(this,n)}}var f=function(t){Object(s.a)(n,t);var e=l(n);function n(t){return Object(a.a)(this,n),e.call(this,t)}return Object(r.a)(n,[{key:\"render\",value:function(){return this.props.condition?this.props.children:null}}]),n}(n.n(o).a.Component);Object(i.a)(f,\"defaultProps\",{condition:!0}),e.a=f},rc3b:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/user/[username]\",function(){return n(\"EE/t\")}])},yLpj:function(t,e){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(a){\"object\"===typeof window&&(n=window)}t.exports=n}},[[\"rc3b\",0,2,1,3,4,5,7,14,15,16,20,27,8]]]);","extractedComments":[]}