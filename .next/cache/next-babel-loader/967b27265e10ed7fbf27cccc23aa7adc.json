{"ast":null,"code":"var __jsx = React.createElement;\nimport React from 'react';\nimport Link from 'next/link';\nimport { Flex } from '@/components/container';\nimport QuickLogin from '@/components/auth';\nimport Button from '@/components/button';\nimport { Modal } from '@/components/popover';\nimport Input from '@/components/input';\nimport { User, Lock } from '@/components/svg';\nimport { login } from '@/utils/api';\nimport { Context } from '@/utils/global';\nimport ShowNotification from '@/utils/notification';\nexport default function Login(props) {\n  const [loading, setLoading] = React.useState(false);\n  const context = React.useContext(Context); //   const [getUsername, setGetUsername] = React.useState<() => string>(() => () => '');\n  //   const [getPassword, setGetPassword] = React.useState<() => string>(() => () => '');\n\n  var getUsername = () => '';\n\n  var getPassword = () => '';\n\n  const loginOK = React.useCallback(() => {\n    setLoading(true);\n    const username = getUsername();\n    const password = getPassword();\n    login(username, password).then(r => {\n      if (ShowNotification(r)) {\n        context.callback({\n          user: r.user\n        });\n        if (!!props.onClose) props.onClose();\n      }\n    }).finally(() => setLoading(false));\n  }, [setLoading, props.onClose, getUsername, getPassword]);\n  return __jsx(Flex, {\n    direction: \"TB\",\n    mainSize: \"large\",\n    fullWidth: true,\n    style: {\n      minWidth: '50vw'\n    }\n  }, __jsx(Input, {\n    prefix: __jsx(User, null),\n    placeholder: \"\\u7528\\u6237\\u540D\",\n    style: {\n      width: '100%'\n    },\n    getValueCallback: cb => getUsername = cb\n  }), __jsx(Input, {\n    type: \"password\",\n    prefix: __jsx(Lock, null),\n    placeholder: \"\\u5BC6\\u7801\",\n    style: {\n      width: '100%'\n    },\n    onEnterPressed: loginOK,\n    getValueCallback: cb => getPassword = cb\n  }), __jsx(QuickLogin, null), __jsx(Flex, null, __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(Button, {\n    neumorphism: true,\n    onClick: e => props.onClose()\n  }, \"\\u6CE8\\u518C\")), __jsx(Button, {\n    neumorphism: true,\n    primary: true,\n    loading: loading,\n    onClick: loginOK\n  }, \"\\u767B\\u5F55\")));\n}\nexport function LoginModal(props) {\n  return __jsx(Modal, {\n    show: props.show,\n    onClose: props.onClose\n  }, __jsx(Login, {\n    onClose: props.onClose\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}