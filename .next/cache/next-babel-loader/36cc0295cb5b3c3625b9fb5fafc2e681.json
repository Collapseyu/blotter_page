{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport Head from 'next/head';\nimport Card from '@/components/card';\nimport Input from '@/components/input';\nimport { Flex } from '@/components/container';\nimport Button from '@/components/button';\nimport { Context } from '@/utils/global';\nimport styles from './sheika.module.scss';\nimport textStyles from '@/styles/text.module.scss';\n\nclass Sheika extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"ref\", /*#__PURE__*/React.createRef());\n\n    _defineProperty(this, \"download\", () => {\n      if (this.ref.current) {\n        var imgURI = this.ref.current.toDataURL(`image/png`).replace(`image/png`, 'image/octet-stream');\n        var evt = new MouseEvent('click', {\n          view: window,\n          bubbles: false,\n          cancelable: true\n        });\n        var a = document.createElement('a');\n        a.setAttribute('download', `logo.png`);\n        a.setAttribute('href', imgURI);\n        a.setAttribute('target', '_blank');\n        a.dispatchEvent(evt);\n      }\n    });\n\n    this.state = {\n      value: 'Hello World!'\n    };\n  }\n\n  componentDidMount() {\n    this.updateCanvas();\n    this.updateCanvas();\n  }\n\n  updateCanvas() {\n    if (this.ref.current) {\n      const size = 16;\n      const width = this.ref.current.clientWidth;\n      const height = this.ref.current.clientHeight;\n      const scale = 10;\n      const scale2 = 2;\n      console.log(width, height);\n      const ctx = this.ref.current.getContext('2d');\n      this.ref.current.height = height * scale2;\n      this.ref.current.width = width * scale2;\n      ctx.scale(scale, scale);\n      this.ref.current.style.width = '100%';\n      ctx.font = `${size}px SheikahGlyphs`;\n      ctx.fillStyle = '#2d91f2';\n      const pre = Math.round(width / scale * scale2 / size) - 1;\n      var value = this.state.value;\n      var line = size;\n      console.log(width, size, pre, line);\n\n      while (value.length > 0) {\n        console.log(line, value.slice(0, pre));\n        ctx.fillText(value.slice(0, pre), 0, line, width);\n        value = value.slice(pre);\n        line += size;\n      }\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxs(Card, {\n      neumorphism: true,\n      className: styles.wrapper,\n      children: [/*#__PURE__*/_jsx(Context.Consumer, {\n        children: context => /*#__PURE__*/_jsx(Head, {\n          children: /*#__PURE__*/_jsx(\"title\", {\n            children: `席卡族文字编码|${context.blog_name}`\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"h1\", {\n        className: textStyles.color,\n        style: {\n          display: 'inline-block',\n          marginRight: 10\n        },\n        children: \"\\u5E2D\\u5361\\u65CF\\u6587\\u5B57\"\n      }), /*#__PURE__*/_jsx(\"p\", {\n        className: textStyles.secondary,\n        style: {\n          display: 'inline-block'\n        },\n        children: \"\\u6587\\u5B57\\u89E3\\u91CA\"\n      }), /*#__PURE__*/_jsxs(\"p\", {\n        style: {\n          margin: 0,\n          marginBottom: 20\n        },\n        children: [\"\\u6765\\u6E90\\u4E8E\\u300A\\u585E\\u5C14\\u8FBE\\u4F20\\u8BF4 \\u65F7\\u91CE\\u4E4B\\u606F\\u300B\\u3002\\u8BE6\\u60C5\\u89C1 \\u300A\", /*#__PURE__*/_jsx(\"a\", {\n          href: \"https://3type.cn/3typezine/typebites/01.html\",\n          children: \"\\u4ECE\\u865A\\u6784\\u4E16\\u754C\\u7684\\u6587\\u5B57\\u8BF4\\u8D77\"\n        }), \"\\u300B\"]\n      }), /*#__PURE__*/_jsxs(Flex, {\n        direction: \"TB\",\n        fullWidth: true,\n        children: [/*#__PURE__*/_jsx(Input, {\n          value: this.state.value,\n          onChange: value => {\n            this.setState({\n              value\n            });\n            this.updateCanvas();\n          }\n        }), /*#__PURE__*/_jsx(\"b\", {\n          children: \"\\u6587\\u672C\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.sheika,\n          children: this.state.value\n        }), /*#__PURE__*/_jsx(\"b\", {\n          children: \"\\u753B\\u677F\"\n        }), /*#__PURE__*/_jsx(Button, {\n          neumorphism: true,\n          onClick: this.download,\n          children: \"\\u4FDD\\u5B58\\u6210\\u56FE\\u7247\"\n        }), /*#__PURE__*/_jsx(\"canvas\", {\n          ref: this.ref\n        })]\n      })]\n    });\n  }\n\n}\n\nexport default Sheika;","map":null,"metadata":{},"sourceType":"module"}