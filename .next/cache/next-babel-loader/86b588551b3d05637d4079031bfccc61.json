{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Link from 'next/link';\nimport { Flex } from '@/components/container';\nimport QuickLogin from '@/components/auth';\nimport Button from '@/components/button';\nimport { Modal } from '@/components/popover';\nimport Input from '@/components/input';\nimport { User, Lock } from '@/components/svg';\nimport { login } from '@/utils/api';\nimport { Context } from '@/utils/global';\nimport ShowNotification from '@/utils/notification';\nexport default function Login(props) {\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      loading = _React$useState2[0],\n      setLoading = _React$useState2[1];\n\n  var context = React.useContext(Context); //   const [getUsername, setGetUsername] = React.useState<() => string>(() => () => '');\n  //   const [getPassword, setGetPassword] = React.useState<() => string>(() => () => '');\n\n  var getUsername = function getUsername() {\n    return '';\n  };\n\n  var getPassword = function getPassword() {\n    return '';\n  };\n\n  var loginOK = React.useCallback(function () {\n    setLoading(true); // var { username, password } = formRef.current.getFieldsValue(['username', 'password']);\n\n    console.log(getUsername, getPassword);\n    var username = getUsername();\n    var password = getPassword();\n    login(username, password).then(function (r) {\n      if (ShowNotification(r)) {\n        context.callback({\n          user: r.user\n        });\n        if (!!props.onClose) props.onClose();\n      }\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  }, [setLoading, props.onClose, getUsername, getPassword]);\n  return __jsx(Flex, {\n    direction: \"TB\",\n    mainSize: \"large\",\n    fullWidth: true,\n    style: {\n      minWidth: '50vw'\n    }\n  }, __jsx(Input, {\n    prefix: __jsx(User, null),\n    placeholder: \"\\u7528\\u6237\\u540D\",\n    style: {\n      width: '100%'\n    },\n    getValueCallback: function getValueCallback(cb) {\n      return getUsername = cb;\n    }\n  }), __jsx(Input, {\n    type: \"password\",\n    prefix: __jsx(Lock, null),\n    placeholder: \"\\u5BC6\\u7801\",\n    style: {\n      width: '100%'\n    },\n    onEnterPressed: loginOK,\n    getValueCallback: function getValueCallback(cb) {\n      return getPassword = cb;\n    }\n  }), __jsx(QuickLogin, null), __jsx(Flex, null, __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(Button, {\n    neumorphism: true,\n    onClick: function onClick(e) {\n      return props.onClose();\n    }\n  }, \"\\u6CE8\\u518C\")), __jsx(Button, {\n    neumorphism: true,\n    primary: true,\n    loading: loading,\n    onClick: loginOK\n  }, \"\\u767B\\u5F55\")));\n}\nexport function LoginModal(props) {\n  return __jsx(Modal, {\n    show: props.show,\n    onClose: props.onClose\n  }, __jsx(Login, {\n    onClose: props.onClose\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}