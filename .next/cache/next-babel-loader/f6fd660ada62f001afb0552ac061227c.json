{"ast":null,"code":"import _toConsumableArray from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/github/workspace/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport Link from 'next/link';\nimport { Map, Marker } from 'react-amap';\nimport If from '@/components/if';\nimport { Star, Dots, FullScreen, FullScreenExit } from '@/components/svg';\nimport Button from '@/components/button';\nimport Popover from '@/components/popover';\nimport Loading from '@/components/loading';\nimport Card from '@/components/card';\nimport { Flex } from '@/components/container';\nimport Timeline from '@/components/timeline';\nimport Drawer from '@/components/drawer';\nimport moment from '@/utils/moment';\nimport { Context } from '@/utils/global';\nimport shadowStyles from '@/styles/shadow.module.scss';\nvar key = '81533a71a4db0eb8107620d99b954d9d';\n\nvar TravelMap = /*#__PURE__*/function (_React$Component) {\n  _inherits(TravelMap, _React$Component);\n\n  var _super = _createSuper(TravelMap);\n\n  function TravelMap(props) {\n    var _this;\n\n    _classCallCheck(this, TravelMap);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"context\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"getZoom\", function () {\n      return typeof _this.state.ins === 'undefined' ? 0 : _this.state.ins.getZoom();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getPos\", function () {\n      return typeof _this.state.ins === 'undefined' ? {\n        P: 0,\n        Q: 0,\n        lng: 0,\n        lat: 0\n      } : _this.state.ins.getCenter();\n    });\n\n    _this.state = {\n      drawer: false,\n      full: false\n    };\n    return _this;\n  }\n\n  _createClass(TravelMap, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return /*#__PURE__*/_jsx(\"div\", {\n        style: this.state.full ? {\n          position: 'fixed',\n          top: 0,\n          bottom: 0,\n          left: 0,\n          right: 0,\n          zIndex: 500,\n          overflow: 'hidden'\n        } : _objectSpread({\n          width: '100%',\n          height: '80vh',\n          overflow: 'hidden',\n          zIndex: 1,\n          position: 'relative'\n        }, this.props.style),\n        children: /*#__PURE__*/_jsxs(Map, {\n          amapkey: key,\n          loading: /*#__PURE__*/_jsx(Loading, {}),\n          mapStyle: this.context.theme === 'default' ? 'amap://styles/f5818203233e77c81d9a6555be54758a' : 'amap://styles/dark',\n          plugins: ['MapType', 'Scale', 'ToolBar'],\n          events: {\n            created: function created(ins) {\n              _this2.setState({\n                ins: ins\n              });\n\n              window.m = ins;\n              ins.setCity('中国');\n              if (!!_this2.props.onCreate) _this2.props.onCreate(ins);\n            }\n          },\n          children: [/*#__PURE__*/_jsx(Button, {\n            icon: /*#__PURE__*/_jsx(Dots, {}),\n            primary: true,\n            circle: true,\n            style: {\n              position: 'absolute',\n              left: '10px',\n              top: '10px'\n            },\n            onClick: function onClick() {\n              return _this2.setState(function (state) {\n                return {\n                  drawer: !state.drawer\n                };\n              });\n            }\n          }), /*#__PURE__*/_jsx(Button, {\n            icon: this.state.full ? /*#__PURE__*/_jsx(FullScreenExit, {}) : /*#__PURE__*/_jsx(FullScreen, {}),\n            circle: true,\n            style: {\n              position: 'absolute',\n              right: '60px',\n              bottom: '30px'\n            },\n            onClick: function onClick() {\n              return _this2.setState(function (state) {\n                return {\n                  full: !state.full\n                };\n              });\n            }\n          }), /*#__PURE__*/_jsx(Drawer, {\n            onClose: function onClose() {\n              return _this2.setState({\n                drawer: false\n              });\n            },\n            show: this.state.drawer,\n            placement: \"left\",\n            containerStyle: {\n              position: 'absolute'\n            },\n            style: {\n              width: '250px'\n            },\n            children: /*#__PURE__*/_jsx(Card, {\n              shadow: true,\n              style: {\n                background: 'var(--background)',\n                transition: 'background var(--transition-time)',\n                height: '100%',\n                overflow: 'auto'\n              },\n              children: /*#__PURE__*/_jsx(Timeline, {\n                data: this.props.cities.map(function (item) {\n                  var result = [];\n                  item.travels.map(function (i) {\n                    return result.push(_objectSpread(_objectSpread({}, item), i));\n                  });\n                  return result;\n                }).reduce(function (a, b) {\n                  return a.concat(b);\n                }, []).sort(function (a, b) {\n                  return a.time - b.time;\n                }).map(function (item, idx) {\n                  return {\n                    time: moment(item.time, 'X').format('YYYY-MM-DD'),\n                    name: /*#__PURE__*/_jsxs(React.Fragment, {\n                      children: [/*#__PURE__*/_jsx(\"a\", {\n                        onClick: function onClick() {\n                          _this2.setState({\n                            drawer: false\n                          });\n\n                          _this2.state.ins.setZoomAndCenter(item.zoom, [item.lng, item.lat]);\n                        },\n                        children: item.name\n                      }), /*#__PURE__*/_jsxs(If, {\n                        condition: !!item.link,\n                        children: [' - ', /*#__PURE__*/_jsx(Link, {\n                          href: \"/post/[url]\",\n                          as: \"/post/\".concat(item.link),\n                          children: /*#__PURE__*/_jsx(\"a\", {\n                            children: \"\\u6E38\\u8BB0\"\n                          })\n                        })]\n                      })]\n                    })\n                  };\n                })\n              })\n            })\n          }), this.props.cities.map(function (item, idx) {\n            return /*#__PURE__*/_jsx(Marker, {\n              position: {\n                longitude: item.lng,\n                latitude: item.lat\n              },\n              children: /*#__PURE__*/_jsx(Popover, {\n                placement: \"top\",\n                trigger: ['click', 'hover'],\n                popoverClass: shadowStyles.shadow,\n                popoverStyle: _defineProperty({\n                  boxShadow: '5px 5px 30px var(--shadow)'\n                }, '--popover-backgroud', 'var(--background)'),\n                component: /*#__PURE__*/_jsx(Card, {\n                  style: {\n                    background: 'var(--background)',\n                    maxWidth: 200\n                  },\n                  children: /*#__PURE__*/_jsx(Flex, {\n                    direction: \"TB\",\n                    fullWidth: true,\n                    children: [/*#__PURE__*/_jsx(\"strong\", {\n                      children: item.name\n                    }, \"name\")].concat(_toConsumableArray(item.travels.sort(function (a, b) {\n                      return a.time - b.time;\n                    }).map(function (c) {\n                      return /*#__PURE__*/_jsxs(Flex, {\n                        children: [moment(c.time, 'X').format('YYYY-MM-DD'), /*#__PURE__*/_jsx(If, {\n                          condition: !!c.link,\n                          children: /*#__PURE__*/_jsx(Link, {\n                            href: \"/post/[url]\",\n                            as: \"/post/\".concat(c.link),\n                            children: /*#__PURE__*/_jsx(\"a\", {\n                              children: \"\\u6E38\\u8BB0\"\n                            })\n                          })\n                        })]\n                      }, c.time);\n                    })))\n                  })\n                }),\n                children: /*#__PURE__*/_jsx(Star, {\n                  style: function () {\n                    var color = _this2.context.theme === 'default' ? 'red' : 'yellow';\n                    var filter = \"drop-shadow(0px 0px 10px \".concat(color, \")\");\n                    return {\n                      color: color,\n                      filter: filter\n                    };\n                  }()\n                })\n              })\n            }, idx);\n          })]\n        })\n      });\n    }\n  }]);\n\n  return TravelMap;\n}(React.Component);\n\n_defineProperty(TravelMap, \"contextType\", Context);\n\n_defineProperty(TravelMap, \"defaultProps\", {\n  cities: []\n});\n\nexport default TravelMap;","map":null,"metadata":{},"sourceType":"module"}